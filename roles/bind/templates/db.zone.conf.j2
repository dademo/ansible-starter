{#- vim: set tabstop=2 shiftwidth=2 expandtab filetype=jinja2 : #}
; Generated by Ansible on {{ '%Y-%m-%d %H:%M:%S' | strftime }}

{# Default TTL to 300 seconds == 1 hour -#}
{%- set _TTL = zone_def.TTL | int | default(3600) -%}
$TTL    {{ _TTL | int }}

@       IN      SOA     {{ zone_def.zone }}. {{ zone_def.admin | default("admin." + zone_def.zone) }}. (
{{ '%30s          ; Serial' | format('%Y%m%d%H' | strftime) }}
{{ '%30s          ; Refresh' | format(zone_def.refresh | default(_TTL) | int) }}
{{ '%30s          ; Retry' | format(zone_def.retry | default(_TTL / 10) | int) }}
{{ '%30s          ; Expire' | format(zone_def.expire | default(_TTL) | int) }}
{{ '%30s )        ; Negative Cache TTL' | format(zone_def.negative_cache_ttl | default(_TTL / 10) | int) }}
;
{% if zone_def.primary_dns_name is defined %}
@       IN      NS      {{ zone_def.primary_dns_name }}.
{% endif %}
{% for _entry in zone_def.entries | selectattr('type', 'equalto', 'MX') %}
@       IN      MX      {{ _entry.priority | default(10) }} {{ _entry.name }}.
{% endfor %}
;
{% for _entry in zone_def.entries | sort(attribute='type,name')| selectattr('type', 'ne', 'MX') %}
{{ '%-40s     IN     %5s     %s' | format(_entry.name, _entry.type, _entry.target) }}
{% endfor %}
